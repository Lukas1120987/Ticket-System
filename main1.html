<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ¢ FunPark â€“ Ticketsystem</title>

<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">

<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --bg:#f5f7fa;
  --card:#fff;
  --primary:#1976d2;
  --text:#222;
}
body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --primary:#90caf9;
  --text:#eee;
}

*{box-sizing:border-box;margin:0;padding:0;font-family:Montserrat,sans-serif}
body{background:var(--bg);color:var(--text);min-height:100vh}

header{
  background:var(--primary);
  color:#fff;
  padding:1rem;
  text-align:center;
}

nav{
  margin-top:.5rem;
  display:flex;
  justify-content:center;
  gap:.5rem;
  flex-wrap:wrap;
}

nav button{
  border:none;
  padding:.5rem .9rem;
  border-radius:6px;
  cursor:pointer;
}

main{
  max-width:1000px;
  margin:2rem auto;
  background:var(--card);
  padding:2rem;
  border-radius:14px;
  box-shadow:0 4px 15px rgba(0,0,0,.2);
}

section{display:none}
section.visible{display:block}

h2{color:var(--primary);margin-bottom:1rem}

form{display:flex;flex-direction:column;gap:1rem}
input,select,button{
  padding:.7rem;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  background:var(--primary);
  color:#fff;
  font-weight:600;
  cursor:pointer;
}

.ticket{
  background:var(--bg);
  padding:1rem;
  border-radius:10px;
  margin-top:1rem;
}

footer{
  text-align:center;
  padding:1rem;
  background:var(--primary);
  color:#fff;
}
.toggle{
  position:fixed;
  right:15px;
  bottom:15px;
  padding:.6rem;
  border-radius:50%;
  font-size:1.2rem;
}
</style>
</head>

<body>

<header>
<h1>ğŸ¢ FunPark</h1>
<p>Statisches Ticketsystem â€“ Demo</p>
<nav>
<button onclick="show('home')">Start</button>
<button onclick="show('buy')">Kaufen</button>
<button onclick="show('view')">Meine Tickets</button>
</nav>
</header>

<main>

<section id="home" class="visible">
<h2>Willkommen</h2>
<p>Buche dein Ticket, zahle sicher und speichere dein Ticket als PDF.</p>
</section>

<section id="buy">
<h2>ğŸŸï¸ Ticket kaufen</h2>
<form id="buyForm">
<select id="user">
<option>Max</option><option>Anna</option><option>Tom</option><option>Lea</option>
</select>

<select id="ticket">
<option value="Tagesticket|35">Tagesticket â€“ 35â‚¬</option>
<option value="2 Tage|60">2 Tage â€“ 60â‚¬</option>
<option value="Familie|90">Familie â€“ 90â‚¬</option>
<option value="VIP|150">VIP â€“ 150â‚¬</option>
</select>

<button>Zur Zahlung ğŸ”</button>
</form>
</section>

<section id="view">
<h2>ğŸ’³ Meine Tickets</h2>
<select id="viewUser">
<option>Max</option><option>Anna</option><option>Tom</option><option>Lea</option>
</select>
<button onclick="showTickets()">Anzeigen</button>
<div id="list"></div>
</section>

</main>

<footer>Â© 2025 FunPark â€“ Demo</footer>

<button class="toggle" onclick="toggleDark()">ğŸŒ™</button>

<script>
let tickets=JSON.parse(localStorage.getItem("tickets"))||[];

function show(id){
 document.querySelectorAll("section").forEach(s=>s.classList.remove("visible"));
 document.getElementById(id).classList.add("visible");
}

/* ========== KAUF & ZAHLUNG ========== */
buyForm.onsubmit=e=>{
 e.preventDefault();
 const [type,price]=ticket.value.split("|");
 const data={user:user.value,type,price};
 localStorage.setItem("pay",JSON.stringify(data));
 openPayment();
};

function openPayment(){
 const w=window.open("","_blank");
 w.document.write(`
 <h2>Sichere Zahlung ğŸ”’</h2>
 <p id="info"></p>
 <progress value="0" max="100" id="p"></progress><br><br>
 <button onclick="pay()">Jetzt bezahlen</button>

 <script>
 const d=JSON.parse(localStorage.getItem("pay"));
 info.innerHTML=\`\${d.type} â€“ <b>\${d.price}â‚¬</b>\`;
 let v=0;
 const i=setInterval(()=>{p.value=v+=10;if(v>=100)clearInterval(i)},200);
 function pay(){
  const code="TCK-"+Math.floor(100000+Math.random()*900000);
  const t=JSON.parse(localStorage.getItem("tickets"))||[];
  t.push({...d,code,redeemed:false});
  localStorage.setItem("tickets",JSON.stringify(t));
  alert("Zahlung erfolgreich!");
  window.close();
 }
 <\/script>
 `);
}

/* ========== TICKETS ========== */
function showTickets(){
 list.innerHTML="";
 tickets=JSON.parse(localStorage.getItem("tickets"))||[];
 tickets.filter(t=>t.user===viewUser.value).forEach(t=>{
  const div=document.createElement("div");
  div.className="ticket";
  div.innerHTML=`
   <b>${t.code}</b><br>${t.type} â€“ ${t.price}â‚¬<br>
   <div id="qr${t.code}"></div>
   <button onclick="pdf('${t.code}','${t.type}','${t.price}')">PDF</button>
  `;
  list.appendChild(div);
  new QRCode(document.getElementById("qr"+t.code),t.code);
 });
}

/* ========== PDF ========== */
function pdf(code,type,price){
 const {jsPDF}=window.jspdf;
 const d=new jsPDF();
 d.text("FunPark Ticket",20,20);
 d.text("Ticket: "+code,20,30);
 d.text(type+" â€“ "+price+"â‚¬",20,40);
 d.save(code+".pdf");
}

/* ========== DARK MODE ========== */
function toggleDark(){
 document.body.classList.toggle("dark");
}
</script>

</body>
</html>
